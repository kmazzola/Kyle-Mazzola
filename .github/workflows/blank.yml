import random

# Open and read the file
file = open("FlashcardSet.txt", "r")
lines = file.readlines()
file.close()

# Create a list to store our flashcards
flashcards = []

# Process each line
for line in lines:
    parts = line.split(":")
    term = parts[0].strip()
    definition = parts[1].strip()
    
    card = {"term": term, "definition": definition}
    flashcards.append(card)

# Shuffle for random order
random.shuffle(flashcards)

print(f"=== Flashcard Study Session ===")
print(f"You have {len(flashcards)} flashcards total")
print(f"Studying in batches of 10\n")

batch_size = 10  # Automatic batch size

# Split into batches
total_correct = 0
total_incorrect = 0

# Calculate how many batches we need
num_batches = (len(flashcards) + batch_size - 1) // batch_size

for batch_num in range(num_batches):
    # Get the cards for this batch
    start = batch_num * batch_size
    end = start + batch_size
    batch = flashcards[start:end]
    
    print(f"\n{'='*40}")
    print(f"BATCH {batch_num + 1} of {num_batches} ({len(batch)} cards)")
    print(f"{'='*40}\n")
    
    correct = 0
    wrong_cards = []
    
    # Quiz on this batch
    for card in batch:
        print(f"TERM: {card['term']}")
        input("(Press Enter to see definition) ")
        print(f"DEFINITION: {card['definition']}\n")
        
        response = input("Did you get it right? (y/n): ")
        
        if response.lower() == "y":
            correct += 1
            print("âœ“ Correct!\n")
        else:
            wrong_cards.append(card)
            print("âœ— Keep studying!\n")
    
    # Batch results
    incorrect = len(wrong_cards)
    print(f"\n--- Batch {batch_num + 1} Results ---")
    print(f"Correct: {correct}/{len(batch)}")
    print(f"Incorrect: {incorrect}/{len(batch)}")
    
    total_correct += correct
    total_incorrect += incorrect
    
    # Review wrong answers from this batch
    if len(wrong_cards) > 0:
        print(f"\nYou missed {len(wrong_cards)} cards in this batch.")
        print("Let's review them now!\n")
        
        input("(Press Enter to start review) ")
        print("\n=== REVIEW SESSION ===\n")
        
        review_correct = 0
        
        for card in wrong_cards:
            print(f"TERM: {card['term']}")
            input("(Press Enter to see definition) ")
            print(f"DEFINITION: {card['definition']}\n")
            
            response = input("Did you get it right this time? (y/n): ")
            
            if response.lower() == "y":
                review_correct += 1
                print("âœ“ Great improvement!\n")
            else:
                print("âœ— Keep practicing this one!\n")
        
        print(f"--- Review Results ---")
        print(f"Improved on: {review_correct}/{len(wrong_cards)}\n")
    else:
        print("ðŸŽ‰ Perfect score on this batch!\n")
    
    # Ask if they want to continue to next batch (unless it's the last one)
    if batch_num < num_batches - 1:
        continue_study = input("Continue to next batch? (y/n): ")
        if continue_study.lower() != "y":
            print("\nStopping study session.")
            break

# Final overall results
print(f"\n{'='*40}")
print(f"OVERALL RESULTS")
print(f"{'='*40}")
print(f"Total Correct: {total_correct}")
print(f"Total Incorrect: {total_incorrect}")
print(f"Overall Score: {total_correct}/{total_correct + total_incorrect} ({100*total_correct//(total_correct + total_incorrect)}%)")
